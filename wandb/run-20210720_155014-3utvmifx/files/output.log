[34m[1mtrain: [39m[22mScanning '/data/aza_s/SIIM/dataset/coco_format/labels/train.cache' for images and labels... 5067 found, 0 missing, 0 empty, 0 corrupted: 100%|█| 5067/5067 [00:00<?, ?
[34m[1mval: [39m[22mScanning '/data/aza_s/SIIM/dataset/coco_format/labels/valid.cache' for images and labels... 1267 found, 0 missing, 0 empty, 0 corrupted: 100%|█| 1267/1267 [00:00<?, ?it
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Plotting labels...
[34m[1mautoanchor: [39m[22mEvolving anchors with Genetic Algorithm: fitness = 0.8486: 100%|███████████████████████████████████████████████████████████| 1000/1000 [00:00<00:00, 1423.42it/s]
Image sizes 640 train, 640 test
Using 8 dataloader workers
Logging results to runs/train/exp5
Starting training for 300 epochs...
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size
  0%|                                                                                                                                                | 0/317 [00:00<?, ?it/s]
[34m[1mautoanchor: [39m[22mAnalyzing anchors... anchors/target = 3.44, Best Possible Recall (BPR) = 0.7931. Attempting to improve anchors, please wait...
[34m[1mautoanchor: [39m[22mWARNING: Extremely small objects found. 1637 of 7912 labels are < 3 pixels in size.
[34m[1mautoanchor: [39m[22mRunning kmeans for 9 anchors on 6275 points...
[34m[1mautoanchor: [39m[22mthr=0.25: 0.7926 best possible recall, 6.87 anchors past thr
[34m[1mautoanchor: [39m[22mn=9, img_size=640, metric_all=0.445/0.669-mean/best, past_thr=0.575-mean: 66,101,  110,128,  96,215,  157,158,  116,310,  152,259,  207,241,  168,368,  223,415
[34m[1mautoanchor: [39m[22mthr=0.25: 0.7927 best possible recall, 6.84 anchors past thr
[34m[1mautoanchor: [39m[22mn=9, img_size=640, metric_all=0.447/0.673-mean/best, past_thr=0.580-mean: 69,87,  103,118,  91,181,  154,151,  109,271,  141,229,  184,262,  154,333,  211,388
  0%|                                                                                                                                                | 0/317 [00:00<?, ?it/s]/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
     0/299     2.32G    0.1111   0.03133   0.04933    0.1918        41       640:   0%|▏                                                     | 1/317 [00:02<10:43,  2.04s/it]
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])

     0/299     2.94G    0.1077   0.02909   0.04875    0.1855        41       640:   4%|██▏                                                  | 13/317 [00:04<00:47,  6.45it/s]
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])

     0/299     2.94G    0.1004   0.02859    0.0473    0.1763        30       640:   9%|████▋                                                | 28/317 [00:06<00:40,  7.12it/s]
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])

     0/299     2.94G    0.0962   0.02819   0.04653    0.1709        30       640:  13%|███████                                              | 42/317 [00:08<00:39,  6.90it/s]
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])

     0/299     2.94G   0.09303   0.02833   0.04581    0.1672        41       640:  18%|█████████▎                                           | 56/317 [00:10<00:37,  6.91it/s]
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])

     0/299     2.94G   0.09049   0.02831   0.04483    0.1636        31       640:  22%|███████████▊                                         | 71/317 [00:12<00:34,  7.08it/s]
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])

     0/299     2.94G   0.08861   0.02833   0.04391    0.1608        28       640:  27%|██████████████▍                                      | 86/317 [00:14<00:31,  7.31it/s]
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
     0/299     2.94G   0.08801   0.02798   0.04333    0.1593        34       640:  30%|███████████████▉                                     | 95/317 [00:15<00:36,  6.09it/s]
Traceback (most recent call last):
  File "scripts/train.py", line 527, in <module>
    train(hyp, opt, device, tb_writer, wandb)
  File "scripts/train.py", line 294, in train
    loss, loss_items = compute_loss(pred, targets.to(device))  # loss scaled by batch_size
  File "./od/models/loss/yolo.py", line 132, in __call__
    iou = bbox_iou(pbox.T, tbox[i], x1y1x2y2=False, CIoU=True)  # iou(prediction, target)
  File "./utils/general.py", line 319, in bbox_iou
    iou = inter / union
KeyboardInterrupt
Images sizes do not match. This will causes images to be display incorrectly in the UI.
Exception in thread Thread-13:
Traceback (most recent call last):
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/threading.py", line 926, in _bootstrap_inner
    self.run()
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in _pin_memory_loop
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/queues.py", line 113, in get
    return _ForkingPickler.loads(res)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/torch/multiprocessing/reductions.py", line 289, in rebuild_storage_fd
    fd = df.detach()
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/connection.py", line 492, in Client
    c = SocketClient(address)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/connection.py", line 620, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])
torch.Size([16, 128, 80, 80])
torch.Size([16, 256, 40, 40])
torch.Size([16, 256, 20, 20])