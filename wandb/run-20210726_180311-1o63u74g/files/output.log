[34m[1mtrain: [39m[22mScanning '/data/aza_s/SIIM/dataset/coco_format/labels/train.cache' for images and labels... 5067 found, 0 missing, 0 empty, 0 corrupted: 100%|█| 5067/5067 [00:00<?, ?it/s]
[34m[1mval: [39m[22mScanning '/data/aza_s/SIIM/dataset/coco_format/labels/valid.cache' for images and labels... 1267 found, 0 missing, 0 empty, 0 corrupted: 100%|███| 1267/1267 [00:00<?, ?it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Plotting labels...
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[34m[1mautoanchor: [39m[22mEvolving anchors with Genetic Algorithm: fitness = 0.8485:  60%|███████████████████████████████████████▊                          | 603/1000 [00:00<00:00, 859.94it/s]
[34m[1mautoanchor: [39m[22mAnalyzing anchors... anchors/target = 3.44, Best Possible Recall (BPR) = 0.7931. Attempting to improve anchors, please wait...
[34m[1mautoanchor: [39m[22mWARNING: Extremely small objects found. 1637 of 7912 labels are < 3 pixels in size.
[34m[1mautoanchor: [39m[22mRunning kmeans for 9 anchors on 6275 points...
[34m[1mautoanchor: [39m[22mthr=0.25: 0.7926 best possible recall, 6.87 anchors past thr
[34m[1mautoanchor: [39m[22mEvolving anchors with Genetic Algorithm: fitness = 0.8486: 100%|█████████████████████████████████████████████████████████████████| 1000/1000 [00:01<00:00, 747.32it/s]
Image sizes 640 train, 640 test
Using 8 dataloader workers
Logging results to runs/train/exp49
Starting training for 300 epochs...
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size
  0%|                                                                                                                                                     | 0/317 [00:00<?, ?it/s]
[34m[1mautoanchor: [39m[22mthr=0.25: 0.7927 best possible recall, 6.84 anchors past thr
[34m[1mautoanchor: [39m[22mn=9, img_size=640, metric_all=0.447/0.673-mean/best, past_thr=0.580-mean: 69,87,  103,118,  91,181,  154,151,  109,271,  141,229,  184,262,  154,333,  211,388













































































































































     0/299     20.2G   0.07886    0.0281    0.4662     0.107        27       640: 100%|█████████████████████████████████████████████████████████| 317/317 [04:52<00:00,  1.08it/s]












               Class      Images     Targets           P           R      mAP@.5  mAP@.5:.95:  98%|█████████████████████████████████████████████▊ | 39/40 [00:27<00:00,  1.63it/s]
                 all    1.27e+03    1.98e+03     0.00739       0.428     0.00414    0.000667
None
0.49118374890364613
0.5003222856800228
0.5072826414931678
               Class      Images     Targets           P           R      mAP@.5  mAP@.5:.95: 100%|███████████████████████████████████████████████| 40/40 [00:31<00:00,  1.28it/s]
Images sizes do not match. This will causes images to be display incorrectly in the UI.
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size










































































































































     1/299       24G     0.068   0.02802     0.439   0.09603        23       640: 100%|█████████████████████████████████████████████████████████| 317/317 [04:37<00:00,  1.14it/s]











               Class      Images     Targets           P           R      mAP@.5  mAP@.5:.95: 100%|███████████████████████████████████████████████| 40/40 [00:23<00:00,  1.68it/s]
                 all    1.27e+03    1.98e+03     0.00777       0.377     0.00883     0.00357
None
0.49528097982708935
0.4894932369973967
0.4770270270270271
0.5241034452374658
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size






































































































































     2/299       24G   0.06452   0.02688    0.4489   0.09139        19       640: 100%|█████████████████████████████████████████████████████████| 317/317 [04:30<00:00,  1.17it/s]











               Class      Images     Targets           P           R      mAP@.5  mAP@.5:.95: 100%|███████████████████████████████████████████████| 40/40 [00:23<00:00,  1.74it/s]
                 all    1.27e+03    1.98e+03      0.0984       0.248      0.0515     0.00894
None
0.5335922816689638
0.4867550578865054
0.46860640544851073
0.5636575909771786
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size





































































































































     3/299       24G   0.06064   0.02512    0.4443   0.08576        17       640: 100%|█████████████████████████████████████████████████████████| 317/317 [04:29<00:00,  1.18it/s]











               Class      Images     Targets           P           R      mAP@.5  mAP@.5:.95: 100%|███████████████████████████████████████████████| 40/40 [00:22<00:00,  1.76it/s]
                 all    1.27e+03    1.98e+03       0.197       0.284      0.0949      0.0209
None
0.5057574238817191
0.44726007205208534
0.4920406051984999
0.5983831174552825
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size






































































     4/299       24G   0.05889   0.02483    0.4236   0.08371        30       640:  53%|██████████████████████████████▏                          | 168/317 [02:23<02:07,  1.17it/s]
Traceback (most recent call last):
  File "scripts/train.py", line 536, in <module>
    logger.info(f'Start Tensorboard with "tensorboard --logdir {opt.project}", view at http://localhost:6006/')
  File "scripts/train.py", line 312, in train
    scaler.step(optimizer)  # optimizer.step
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/torch/cuda/amp/grad_scaler.py", line 338, in step
    retval = self._maybe_opt_step(optimizer, optimizer_state, *args, **kwargs)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/torch/cuda/amp/grad_scaler.py", line 284, in _maybe_opt_step
    if not sum(v.item() for v in optimizer_state["found_inf_per_device"].values()):
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/torch/cuda/amp/grad_scaler.py", line 284, in <genexpr>
    if not sum(v.item() for v in optimizer_state["found_inf_per_device"].values()):
