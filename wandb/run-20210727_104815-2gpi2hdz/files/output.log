[34m[1mtrain: [39m[22mScanning '/data/aza_s/SIIM/dataset/coco_format/labels/train.cache' for images and labels... 5067 found, 0 missing, 0 empty, 0 corrupted: 100%|█| 5067/5067 [00:00<?, ?it/s]
[34m[1mval: [39m[22mScanning '/data/aza_s/SIIM/dataset/coco_format/labels/valid.cache' for images and labels... 1267 found, 0 missing, 0 empty, 0 corrupted: 100%|███| 1267/1267 [00:00<?, ?it/s]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
Plotting labels...
[34m[1mautoanchor: [39m[22mEvolving anchors with Genetic Algorithm::   0%|                                                                                              | 0/1000 [00:00<?, ?it/s]
[34m[1mautoanchor: [39m[22mAnalyzing anchors... anchors/target = 3.44, Best Possible Recall (BPR) = 0.7931. Attempting to improve anchors, please wait...
[34m[1mautoanchor: [39m[22mWARNING: Extremely small objects found. 1637 of 7912 labels are < 3 pixels in size.
[34m[1mautoanchor: [39m[22mRunning kmeans for 9 anchors on 6275 points...
[34m[1mautoanchor: [39m[22mthr=0.25: 0.7926 best possible recall, 6.87 anchors past thr
[34m[1mautoanchor: [39m[22mEvolving anchors with Genetic Algorithm: fitness = 0.8486: 100%|████████████████████████████████████████████████████████████████| 1000/1000 [00:00<00:00, 1158.30it/s]
Image sizes 640 train, 640 test
Using 8 dataloader workers
Logging results to runs/train/exp5
Starting training for 300 epochs...
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size
  0%|                                                                                                                                                     | 0/317 [00:00<?, ?it/s]/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
[34m[1mautoanchor: [39m[22mthr=0.25: 0.7927 best possible recall, 6.84 anchors past thr
[34m[1mautoanchor: [39m[22mn=9, img_size=640, metric_all=0.447/0.673-mean/best, past_thr=0.580-mean: 69,87,  103,118,  91,181,  154,151,  109,271,  141,229,  184,262,  154,333,  211,388
[34m[1mautoanchor: [39m[22mOriginal anchors better than new anchors. Proceeding with original anchors.





















     0/299     2.42G   0.08188   0.02688    0.4814    0.1088        21       640: 100%|█████████████████████████████████████████████████████████| 317/317 [00:47<00:00,  6.63it/s]





               Class      Images     Targets           P           R      mAP@.5  mAP@.5:.95:  95%|████████████████████████████████████████████▋  | 38/40 [00:09<00:00,  4.23it/s]
               Class      Images     Targets           P           R      mAP@.5  mAP@.5:.95: 100%|███████████████████████████████████████████████| 40/40 [00:10<00:00,  3.65it/s]
Process Process-19:
Traceback (most recent call last):
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/mean_average_precision/multiprocessing.py", line 117, in _proc_loop
    metric_fn.add(preds, gt)
  File "<string>", line 2, in add
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/managers.py", line 834, in _callmethod
    raise convert_to_error(kind, result)
AssertionError
Bin acc: 1.0  0.0  0.0  0.0  0.0. mAP: 0.0009495415841868573
Process Process-21:
Traceback (most recent call last):
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/mean_average_precision/multiprocessing.py", line 117, in _proc_loop
    metric_fn.add(preds, gt)
  File "<string>", line 2, in add
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/managers.py", line 834, in _callmethod
    raise convert_to_error(kind, result)
AssertionError
Process Process-23:
Traceback (most recent call last):
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/mean_average_precision/multiprocessing.py", line 117, in _proc_loop
    metric_fn.add(preds, gt)
  File "<string>", line 2, in add
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/managers.py", line 834, in _callmethod
    raise convert_to_error(kind, result)
AssertionError
Process Process-25:
Traceback (most recent call last):
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/mean_average_precision/multiprocessing.py", line 117, in _proc_loop
    metric_fn.add(preds, gt)
  File "<string>", line 2, in add
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/managers.py", line 834, in _callmethod
    raise convert_to_error(kind, result)
AssertionError
Images sizes do not match. This will causes images to be display incorrectly in the UI.
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size




















     1/299     2.93G   0.07101   0.02735    0.4467   0.09836        27       640: 100%|█████████████████████████████████████████████████████████| 317/317 [00:42<00:00,  7.49it/s]



               Class      Images     Targets           P           R      mAP@.5  mAP@.5:.95: 100%|███████████████████████████████████████████████| 40/40 [00:08<00:00,  4.92it/s]
Process Process-27:
Traceback (most recent call last):
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/mean_average_precision/multiprocessing.py", line 117, in _proc_loop
    metric_fn.add(preds, gt)
  File "<string>", line 2, in add
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/managers.py", line 834, in _callmethod
    raise convert_to_error(kind, result)
AssertionError
                 all    1.27e+03    1.98e+03      0.0275      0.0444     0.00713     0.00109
Bin acc: 1.0  0.0  0.0  0.0  0.0. mAP: 0.0014254039528266043
Process Process-29:
Traceback (most recent call last):
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/mean_average_precision/multiprocessing.py", line 117, in _proc_loop
    metric_fn.add(preds, gt)
  File "<string>", line 2, in add
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/managers.py", line 834, in _callmethod
    raise convert_to_error(kind, result)
AssertionError
Process Process-31:
Traceback (most recent call last):
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/mean_average_precision/multiprocessing.py", line 117, in _proc_loop
    metric_fn.add(preds, gt)
  File "<string>", line 2, in add
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/managers.py", line 834, in _callmethod
    raise convert_to_error(kind, result)
AssertionError
Process Process-33:
Traceback (most recent call last):
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/process.py", line 99, in run
    self._target(*self._args, **self._kwargs)
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/site-packages/mean_average_precision/multiprocessing.py", line 117, in _proc_loop
    metric_fn.add(preds, gt)
  File "<string>", line 2, in add
  File "/home/ubuntu/miniconda3/envs/temp/lib/python3.7/multiprocessing/managers.py", line 834, in _callmethod
    raise convert_to_error(kind, result)
AssertionError
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size
     2/299     2.93G   0.06708   0.03042    0.4087   0.09751        45       640:   6%|███▎                                                      | 18/317 [00:02<00:40,  7.34it/s]
     2/299     2.93G   0.06639    0.0304    0.4003   0.09679        49       640:  11%|██████▍                                                   | 35/317 [00:04<00:33,  8.37it/s]
     2/299     2.93G   0.06568   0.03052    0.4021    0.0962        29       640:  16%|█████████▏                                                | 50/317 [00:06<00:32,  8.18it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     2/299     2.93G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
Process Process-39:G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
Process Process-39:G   0.06575   0.02986    0.4132   0.09561        34       640:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]
     Epoch   gpu_mem       box       obj       cls     total   targets  img_size:  21%|████████████                                              | 66/317 [00:08<00:31,  7.97it/s]